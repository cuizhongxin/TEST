<!--pages/tactics/tactics.wxml-->
<view class="page-container">
  <view class="header">
    <text class="title">å…µæ³•ç ”ä¹ </text>
  </view>

  <!-- æ­¦å°†é€‰æ‹© -->
  <view class="general-section">
    <text class="section-title">é€‰æ‹©æ­¦å°†</text>
    <scroll-view class="general-list" scroll-x="true">
      <view class="general-item {{currentGeneralId === item.id ? 'active' : ''}}" 
            wx:for="{{generals}}" wx:key="id" 
            bindtap="selectGeneral" data-id="{{item.id}}">
        <view class="general-avatar">
          <image src="{{item.avatar || '/images/logo.png'}}" mode="aspectFill"></image>
        </view>
        <text class="general-name">{{item.name}}</text>
        <text class="troop-type">{{item.troopType || 'æ­¥å…µ'}}</text>
      </view>
    </scroll-view>
  </view>

  <!-- å½“å‰è£…å¤‡çš„å…µæ³• -->
  <view class="equipped-section" wx:if="{{currentGeneral}}">
    <text class="section-title">{{currentGeneral.name}}å·²è£…å¤‡ (åªèƒ½è£…å¤‡1ä¸ª)</text>
    <view class="equipped-card" wx:if="{{currentGeneral.tactics && currentGeneral.tactics.primary}}">
      <view class="equipped-info">
        <text class="equipped-name">{{currentGeneral.tactics.primary.name}}</text>
        <text class="equipped-type {{currentGeneral.tactics.primary.type}}">
          {{currentGeneral.tactics.primary.type === 'formation' ? 'é˜µæ³•' : 'å…µæ³•'}}
        </text>
      </view>
      <view class="unequip-btn" bindtap="unequipTactics">å¸ä¸‹</view>
    </view>
    <view class="equipped-empty" wx:else>
      <text>æœªè£…å¤‡å…µæ³•æˆ–é˜µæ³•</text>
    </view>
  </view>

  <!-- å…µæ³•åˆ†ç±» -->
  <view class="tab-section">
    <view class="tab-item {{currentTab === 'formation' ? 'active' : ''}}" bindtap="switchTab" data-tab="formation">é˜µæ³•</view>
    <view class="tab-item {{currentTab === 'tactics' ? 'active' : ''}}" bindtap="switchTab" data-tab="tactics">å…µæ³•</view>
  </view>

  <!-- å¯å­¦ä¹ åˆ—è¡¨ -->
  <scroll-view class="tactics-scroll" scroll-y="true">
    <view class="tactics-list">
      <view class="tactics-card {{item.quality}}" wx:for="{{displayList}}" wx:key="id">
        <view class="tactics-header">
          <text class="tactics-name">{{item.name}}</text>
          <text class="tactics-type-tag {{item.type}}">{{item.type === 'formation' ? 'é˜µæ³•' : 'å…µæ³•'}}</text>
          <text class="troop-req" wx:if="{{item.troopRequirement}}">{{item.troopRequirement}}ä¸“å±</text>
        </view>
        <text class="tactics-desc">{{item.description}}</text>
        <view class="tactics-effect">
          <text class="effect-label">æ•ˆæœ:</text>
          <text class="effect-text">{{item.effectText}}</text>
        </view>
        <view class="tactics-cost">
          <text class="cost-item">ğŸ“„çº¸å¼ Ã—{{item.paperCost}}</text>
          <text class="cost-item">ğŸªµæœ¨æÃ—{{item.woodCost}}</text>
          <text class="cost-item">ğŸ’°é“¶ä¸¤Ã—{{item.silverCost}}</text>
        </view>
        <view class="tactics-btns">
          <view class="tactics-btn learn {{item.learned ? 'disabled' : ''}}" bindtap="learnTactics" data-id="{{item.id}}">
            {{item.learned ? 'å·²å­¦ä¹ ' : 'å­¦ä¹ '}}
          </view>
          <view class="tactics-btn equip" wx:if="{{item.learned}}" bindtap="equipTactics" data-id="{{item.id}}">è£…å¤‡</view>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- èµ„æºæ˜¾ç¤º -->
  <view class="resource-bar">
    <text>ğŸ“„çº¸å¼ : {{paper}}</text>
    <text>ğŸªµæœ¨æ: {{wood}}</text>
    <text>ğŸ’°é“¶ä¸¤: {{silver}}</text>
  </view>
</view>
