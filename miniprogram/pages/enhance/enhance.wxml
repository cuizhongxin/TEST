<!--pages/enhance/enhance.wxml-->
<view class="page-container">
  <view class="header">
    <text class="title">装备强化</text>
  </view>

  <!-- 武将选择 -->
  <view class="general-section">
    <text class="section-title">选择武将</text>
    <scroll-view class="general-list" scroll-x="true">
      <view class="general-item {{currentGeneralId === item.id ? 'active' : ''}}" 
            wx:for="{{generals}}" wx:key="id" 
            bindtap="selectGeneral" data-id="{{item.id}}">
        <view class="general-avatar">
          <image src="{{item.avatar || '/images/logo.png'}}" mode="aspectFill"></image>
        </view>
        <text class="general-name">{{item.name}}</text>
      </view>
    </scroll-view>
  </view>

  <!-- 装备列表 -->
  <view class="equip-section" wx:if="{{currentGeneral}}">
    <text class="section-title">{{currentGeneral.name}}的装备</text>
    <view class="equip-list">
      <view class="equip-item {{selectedEquipId === item.id ? 'active' : ''}}" 
            wx:for="{{equipments}}" wx:key="id"
            bindtap="selectEquip" data-id="{{item.id}}">
        <text class="equip-name" style="color: {{item.qualityColor}}">{{item.name}}</text>
        <text class="equip-level">+{{item.enhanceLevel || 0}}</text>
        <text class="equip-attr">机动性 +{{item.mobility || 0}}</text>
      </view>
      <view class="empty-tip" wx:if="{{equipments.length === 0}}">
        <text>暂无装备</text>
      </view>
    </view>
  </view>

  <!-- 强化信息 -->
  <view class="enhance-info" wx:if="{{selectedEquip}}">
    <text class="section-title">强化预览</text>
    <view class="info-card">
      <view class="info-row">
        <text class="info-label">当前等级:</text>
        <text class="info-value">+{{selectedEquip.enhanceLevel || 0}}</text>
      </view>
      <view class="info-row">
        <text class="info-label">强化后:</text>
        <text class="info-value highlight">+{{(selectedEquip.enhanceLevel || 0) + 1}}</text>
      </view>
      <view class="info-row">
        <text class="info-label">机动性:</text>
        <text class="info-value">{{selectedEquip.mobility || 0}} → {{getNextMobility(selectedEquip)}}</text>
      </view>
      <view class="info-row">
        <text class="info-label">消耗:</text>
        <text class="info-value cost">强化石×1 银两×{{getEnhanceCost(selectedEquip)}}</text>
      </view>
    </view>
    <view class="enhance-btn" bindtap="doEnhance">强化</view>
  </view>

  <!-- 资源显示 -->
  <view class="resource-bar">
    <text>强化石: {{enhanceStone}}</text>
    <text>银两: {{silver}}</text>
  </view>
</view>
